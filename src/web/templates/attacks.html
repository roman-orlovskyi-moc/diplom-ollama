{% extends "base.html" %}

{% block title %}Attack Library{% endblock %}

{% block content %}
<h1><i class="bi bi-bug"></i> Attack Pattern Library</h1>
<p class="lead">Browse all {{ attacks|length }} prompt injection attack patterns.</p>

<div class="row mt-4">
    <div class="col-md-12">
        <ul class="nav nav-tabs" id="categoryTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all" type="button">
                    All ({{ attacks|length }})
                </button>
            </li>
            {% for category in categories %}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="{{ category }}-tab" data-bs-toggle="tab" data-bs-target="#{{ category }}" type="button">
                    {{ category|replace('_', ' ')|title }}
                </button>
            </li>
            {% endfor %}
        </ul>

        <div class="tab-content mt-3" id="categoryTabContent">
            <div class="tab-pane fade show active" id="all" role="tabpanel">
                {% for attack in attacks %}
                    {% include 'attack_card.html' %}
                {% endfor %}
            </div>

            {% for category in categories %}
            <div class="tab-pane fade" id="{{ category }}" role="tabpanel">
                {% for attack in attacks %}
                    {% if attack.category == category %}
                        {% include 'attack_card.html' %}
                    {% endif %}
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}